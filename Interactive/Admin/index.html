{% extends "partials/base.html" %}
{% load static %}
{% block title %}Dashboard{% endblock title %}
{% block extra_css %}
    <!-- jsvectormap css -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>
    <script src = "https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
      <script src = "https://code.highcharts.com/highcharts.js"></script>
    <link href="{% static 'libs/jsvectormap/dist/css/jsvectormap.min.css'%}" rel="stylesheet" type="text/css" />
    <!--Swiper slider css-->
    <link href="{% static 'libs/swiper/swiper-bundle.min.css'%}" rel="stylesheet" type="text/css" />

    <link href="{% static 'css/dashboards.css'%}" rel="stylesheet" type="text/css" />
        <link
      href="{% static 'fontawesomefree/css/fontawesome.css' %}"
      rel="stylesheet"
      type="text/css"
    />
    <link
      href="{% static 'fontawesomefree/css/brands.css' %}"
      rel="stylesheet"
      type="text/css"
    />
    <link
      href="{% static 'fontawesomefree/css/solid.css' %}"
      rel="stylesheet"
      type="text/css"
    />
{% endblock extra_css %}

{% block content %}
        <!-- ============================================================== -->
        <!-- Start right Content here -->
        <!-- ============================================================== -->
        <div class="main-content">

            <div class="page-content">
                <div class="container-fluid">

                    <div class="row">
                        <div class="col">

                            <div class="h-100">
                                <div class="row mb-3 pb-1">
                                    <div class="col-12">
                                        <div class="d-flex align-items-lg-center flex-lg-row flex-column">
                                            <div class="flex-grow-1">
                                            </div>
                                            <div class="mt-3 mt-lg-0">
                                                <form  method="post">
                                                {% csrf_token %}
                                                    <select
                                                        name="tag_id_check"
                                                        class="form-select"
                                                        aria-label="Default select example"
                                                        style="height: 43px"
                                                        id="validationCustom04"
                                                        required
                                                    >
                                                        <option selected disabled value="">Chọn ngành</option>
                                                        {% for i in tag %}
                                                        <option value="{{i.id}}">{{i.name}}</option>
                                                        {% endfor %}
                                                    </select>
                                                    <button
                                                        type="submit"
                                                        class="btn btn-success waves-effect waves-light"
                                                    >
                                                        Xem
                                                    </button>
                                                </form>
                                            </div>
                                        </div><!-- end card header -->
                                    </div><!--end col-->
                                </div><!--end row-->

                                <div class="row">
                                    <div class="col-xl-6 ">
                                        <!-- card -->
                                        <div class="card card-animate">
                                            <div class="card-body">
                                                <div class="d-flex align-items-center">
                                                    <div class="row">
                                                        <div class="flex-grow-1 overflow-hidden">
                                                            <h4 class="text-uppercase fw-medium text-muted text-truncate mb-0">Giới Tính</h4>
                                                        </div>
                                                        <div class="avatar-sm flex-shrink-0">
                                                            <span class="avatar-title rounded fs-3" style="background-color:#C1FFD8">
                                                                <i class='bx bx-user-circle' style="color:#00AC41"></i>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="d-flex align-items-end justify-content-between mt-4">
                                                    <div>
                                                        {% with report=report_detail %}
                                                            <h4 class="mt-4 ff-secondary fw-semibold">Nam: <span class="counter-value" data-target="{{report.genders.0.value}}">0</span> người</h4>
                                                            <h4 class="mt-4 ff-secondary fw-semibold">Nữ: <span class="counter-value" data-target="{{report.genders.1.value}}">0</span> người</h4>
                                                        {% endwith %}
                                                    </div>
                                                </div>
                                            </div><!-- end card body -->
                                        </div><!-- end card -->
                                    </div><!-- end col -->

                                    <div class="col-xl-6 ">
                                        <!-- card -->
                                        <div class="card card-animate">
                                            <div class="card-body">
                                                <div class="d-flex align-items-center">
                                                    <div class="row">
                                                        <div class="flex-grow-1 overflow-hidden">
                                                            <h3 class="text-uppercase fw-medium text-muted text-truncate mb-0">Tình trạng hôn nhân</h3>
                                                        </div>
                                                        <div class="avatar-sm flex-shrink-0">
                                                            <span class="avatar-title rounded fs-3" style="background-color:#FFDADA">
                                                                <i class='bx bxs-heart-circle' style="color:red"></i>
                                                            </span>
                                                        </div>
                                                    </div>
                                                    <div class="flex-shrink-0">
                                                        <h5 class="text-danger fs-14 mb-0">
                                                            {% comment %} <i class="ri-arrow-right-down-line fs-13 align-middle"></i> -3.57 % {% endcomment %}
                                                        </h5>
                                                    </div>
                                                </div>
                                                <div class="d-flex align-items-end justify-content-between mt-4">
                                                    <div>
                                                        {% with report=report_detail %}
                                                            <h4 class="mt-4 ff-secondary fw-semibold">Đã kết hôn: <span class="counter-value" data-target="{{report.marital_status.0.value}}">0</span> người</h4>
                                                            <h4 class="mt-4 ff-secondary fw-semibold">Chưa kết hôn: <span class="counter-value" data-target="{{report.marital_status.1.value}}">0</span> người</h4>
                                                        {% endwith %}
                                                    </div>
                                                </div>
                                            </div><!-- end card body -->
                                        </div><!-- end card -->
                                    </div><!-- end col -->
                                    </div>
                                    <div class="row">
                                    <div class="col-xl-12 col-md-12">
                                        <!-- card -->
                                        <div class="card card-animate">
                                            <div class="card-body">
                                                <div class="d-flex align-items-center">
                                                    <div class="row">
                                                        <div class="flex-grow-1 overflow-hidden">
                                                            <h3 class="text-uppercase fw-medium text-muted text-truncate mb-0">Học vấn</h3>
                                                        </div>
                                                        <div class="avatar-sm flex-shrink-0" >
                                                            <span class="avatar-title bg-soft-primary rounded fs-3" >
                                                                <i class="fa-solid fa-book-bookmark" style="color:#135BFF;"></i>
                                                            </span>
                                                        </div>
                                                    </div>
                                                    <div class="flex-shrink-0">
                                                        <h5 class="text-success fs-14 mb-0">
                                                            {% comment %} <i class="ri-arrow-right-up-line fs-13 align-middle"></i> +29.08 % {% endcomment %}
                                                        </h5>
                                                    </div>
                                                </div>
                                                <div class="d-flex align-items-end justify-content-between mt-4">
                                                    {% with report=report_detail %}
                                                    <div class="row" style="margin-bottom:-10px">
                                                        <h4 class="mt-4 ff-secondary fw-semibold">Trung học: <span class="counter-value" data-target="{{report.educational_attainment.0.value}}">0</span> người</h4>
                                                        <h4 class="mt-4 ff-secondary fw-semibold">Cử nhân: <span class="counter-value" data-target="{{report.educational_attainment.1.value}}">0</span> người</h4>
                                                    </div>
                                                    <div class="row" style="margin-top:-50px;margin-bottom:-10px" >
                                                        <h4 class="mt-4 ff-secondary fw-semibold">Sau đại học: <span class="counter-value" data-target="{{report.educational_attainment.2.value}}">0</span> người</h4>
                                                        <h4 class="mt-4 ff-secondary fw-semibold">Chuyên gia: <span class="counter-value" data-target="{{report.educational_attainment.3.value}}">0</span> người</h4>
                                                    </div>
                                                    {% endwith %}
                                                </div>
                                            </div><!-- end card body -->
                                        </div><!-- end card -->
                                    </div><!-- end col -->

                                    <div class="col-xl-12 col-md-12">
                                        <!-- card -->
                                        <div class="card card-animate">
                                            <div class="card-body">
                                                <div class="d-flex align-items-center">
                                                    <div class="row" >
                                                        <div class="flex-grow-1 overflow-hidden">
                                                            <h3 class="text-uppercase fw-medium text-muted text-truncate mb-0">Nghề nghiệp</h3>
                                                        </div>
                                                        <div class="avatar-sm flex-shrink-0" >
                                                            <span class="avatar-title rounded fs-3" style="background-color:#FFF2E0">
                                                                <i class='bx bx-credit-card' style="color:orange"></i>
                                                            </span>
                                                        </div>
                                                    </div>
                                                    <div class="flex-shrink-0">
                                                        {% comment %} <h5 class="text-muted fs-14 mb-0">
                                                            +0.00 %
                                                        </h5> {% endcomment %}
                                                    </div>
                                                </div>
                                                <div class="d-flex align-items-end justify-content-between mt-4">
                                                    {% with report=report_detail %}
                                                    <div class="row" style="margin-top:-65px;margin-bottom:-20px">
                                                        <h4 class="mt-4 ff-secondary fw-semibold">HS-SV: <span class="counter-value" data-target="{{report.jod.0.value}}">0</span> người</h4>
                                                        <h4 class="mt-4 ff-secondary fw-semibold">Thực tập sinh: <span class="counter-value" data-target="{{report.jod.1.value}}">0</span> người</h4>
                                                        <h4 class="mt-4 ff-secondary fw-semibold">Mới làm việc: <span class="counter-value" data-target="{{report.jod.2.value}}">0</span> người</h4>
                                                    </div>
                                                    <div class="row" style="margin-top:-40px;margin-bottom:-20px">
                                                        <h4 class="mt-4 ff-secondary fw-semibold">Quản lý: <span class="counter-value" data-target="{{report.jod.3.value}}">0</span> người</h4>
                                                        <h4 class="mt-4 ff-secondary fw-semibold">Điều hành: <span class="counter-value" data-target="{{report.jod.4.value}}">0</span> người</h4>
                                                    </div>
                                                        {% endwith %}
                                                </div>
                                            </div><!-- end card body -->
                                        </div><!-- end card -->
                                    </div><!-- end col -->
                                </div> <!-- end row-->

                                <div class="row">
                                    <div class="col-xl-6 col-md-12">
                                        <div class="card card-height-100">
                                            <div class="card-header align-items-center d-flex">
                                                <h4 class="card-title mb-0 flex-grow-1">Học vấn</h4>
                                            </div><!-- end card header -->
                                            <div class="card-body">
                                                <canvas id="Chart1" style="margin-top:-30px;height:400px;width:770.667px"></canvas>
                                                {% comment %} <canvas id="myChartTr" class="apex-charts canvas" dir="ltr" ></canvas> {% endcomment %}
                                            </div>
                                        </div> <!-- .card-->
                                    </div> <!-- .col-->
                                    <div class="col-xl-6 col-md-12">
                                        <div class="card">
                                            <div class="card-header align-items-center d-flex">
                                                <h4 class="card-title mb-0 flex-grow-1">Độ tuổi phổ biến</h4>
                                            </div><!-- end card header -->
                                            <div class="card-body p-0 pb-2">
                                                 <div id = "container" style = "width: 500px; height: 400px; margin: 0 auto"></div>
                                                {% comment %} <div id="customer_impression_charts" data-colors='["--vz-info", "--vz-primary", "--vz-danger"]' class="apex-charts" dir="ltr"></div> {% endcomment %}
                                            </div><!-- end card body -->
                                        </div><!-- end card -->
                                    </div><!-- end col -->
                                    <!-- end col -->
                                </div>

                                <div class="row">
                                    <div class="col-xl-5 col-md-12">
                                        <div class="card">
                                            <div class="card-header align-items-center d-flex">
                                                <h4 class="card-title mb-0 flex-grow-1">Tình trạng hôn nhân</h4>
                                            </div><!-- end card header -->
                                            <div class="card-body p-0 pb-2">
                                                <canvas id="marital_status" ></canvas>
                                            </div><!-- end card body -->
                                        </div><!-- end card -->
                                        <div class="card">
                                            <div class="card-header align-items-center d-flex">
                                                <h4 class="card-title mb-0 flex-grow-1">Giới tính</h4>
                                            </div><!-- end card header -->
                                            <div class="card-body p-0 pb-2">
                                                <canvas id="gender" ></canvas>
                                            </div><!-- end card body -->
                                        </div><!-- end card -->
                                    </div><!-- end col -->
                                    <div class="col-xl-7">
                                        <div class="card" style="height:96%">
                                            <div class="card-header align-items-center d-flex" >
                                                <h4 class="card-title mb-0 flex-grow-1">Các bình luận tiêu biểu</h4>
                                                <div class="flex-shrink-0">
                                                    {% comment %} <button type="button" class="btn btn-soft-info btn-sm">
                                                        <i class="ri-file-list-3-line align-middle"></i> Generate Report
                                                    </button> {% endcomment %}
                                                </div>
                                            </div><!-- end card header -->
                                            <div class="card-body" >
                                                <div class="table-responsive table-card overflow">
                                                    <table class="table table-borderless table-centered align-middle table-nowrap mb-0">
                                                        <thead class="text-muted table-light">

                                                        </thead>
                                                        <tbody>
                                                        {% for i in comment_analysis.comment_positive %}
                                                            <tr>
                                                                <td>{{i}}</td>
                                                            </tr><!-- end tr -->
                                                        {% endfor %}
                                                        </tbody><!-- end tbody -->
                                                    </table><!-- end table -->
                                                </div>
                                            </div>
                                        </div> <!-- .card-->
                                    </div> <!-- .col-->
                                </div> <!-- end row-->
                            </div> <!-- end .h-100-->
                        </div> <!-- end col -->


                    </div>
                    
                </div>
                <!-- container-fluid -->
            </div>
            <!-- End Page-content -->
            {% block footer %}
            {% include "partials/footer.html" %}
            {% endblock footer %}

            <div style="display: none">
                {% with report=report_detail %}
                <div id="ages0">{{report.ages.0.value}}</div>
                <div id="ages1">{{report.ages.1.value}}</div>
                <div id="ages2">{{report.ages.2.value}}</div>
                <div id="ages3">{{report.ages.3.value}}</div>
                <div id="ages4">{{report.ages.4.value}}</div>
                <div id="ages5">{{report.ages.5.value}}</div>
                {% endwith %}
            </div>
            <div style="display: none">
              {% with report=report_detail %}
              <div id="gender0">{{report.genders.0.value}}</div>
              <div id="gender1">{{report.genders.1.value}}</div>
              {% endwith %}
            </div>
            <div style="display: none">
              {% with report=report_detail %}
              <div id="marital0">{{report.marital_status.0.value}}</div>
              <div id="marital1">{{report.marital_status.1.value}}</div>
              {% endwith %}
            </div>
            <div style="display: none">
              {% with report=report_detail %}
              <div id="education0">{{report.educational_attainment.0.value}}</div>
              <div id="education1">{{report.educational_attainment.1.value}}</div>
              <div id="education2">{{report.educational_attainment.2.value}}</div>
              <div id="education3">{{report.educational_attainment.3.value}}</div>
              {% endwith %}
            </div>
        </div>
        <!-- end main content-->
{% endblock content %}

{% block extra_js %}
<script>

    const ctx = document.getElementById("myChart").getContext("2d");
    var xValues = ["13-17", "18-25", "26-34", "35-44", "45-51","55+"];
var yValues = [ages0, ages1, ages2, ages3, ages4, ages5];
var barColors = ["#ffc84b", "#29badb","#f17171","#e8c3b9","#86FEAC","#C4F4FF"];

new Chart("myChart", {
  type: "splineArea",
  data: {
  labels: xValues,
  datasets: [{
    backgroundColor: barColors,
    data: yValues
  }]
},
  options: {
    legend: {display: false},
    title: {
      display: true,
    },
    scales: {
      xAxes: [{ticks: {min: 0, max:300}}]
    }
  }
});
</script>
<script>
    const ages0 = document.getElementById("ages0").innerText;
    const ages1 = document.getElementById("ages1").innerText;
    const ages2 = document.getElementById("ages2").innerText;
    const ages3 = document.getElementById("ages3").innerText;
    const ages4 = document.getElementById("ages4").innerText;
    const ages5 = document.getElementById("ages5").innerText;

         $(document).ready(function() {
            var chart = {
               type: 'areaspline'
            };
            var title = {
               text: ''
            };
            var subtitle = {
               style: {
                  position: 'absolute',
                  right: '0px',
                  bottom: '10px'
               }
            };
            var legend = {
               layout: 'vertical',
               align: 'left',
               verticalAlign: 'top',
               x: 150,
               y: 100,
               floating: true,
               borderWidth: 1,
               backgroundColor: (
                  Highcharts.theme && Highcharts.theme.legendBackgroundColor) ||
                     '#FFFFFF'
            };
            var xAxis = {
               categories: ["13-17", "18-25", "26-34", "35-44", "45-51", "55+"]
            };
            var yAxis = {
               title: {
                  text: ''
               }
            };
            var tooltip = {
               shared: true,
               valueSuffix: ' units'
            };
            var credits = {
               enabled: false
            }
            var plotOptions = {
               areaspline: {
                  fillOpacity: 0.5
               }
            };
            var series = [
               {
                  name: 'Học vấn',
                  data: [ages0, ages1, ages2, ages3, ages4, ages5]
               },
               {
                  name: 'Độ tuổi',
                  data: [1, 3, 4, 3, 3, 5]
               }
            ];

            var json = {};
            json.yValues = yValues;
            json.chart = chart;
            json.title = title;
            json.subtitle = subtitle;
            json.xAxis = xAxis;
            json.yAxis = yAxis;
            json.legend = legend;
            json.plotOptions = plotOptions;
            json.credits = credits;
            json.series = series;
            $('#container').highcharts(json);
         });
      </script>
<script>
      const marital0 = document.getElementById("marital0").innerText;
      const marital1 = document.getElementById("marital1").innerText;


var xValues = ["Đã kết hôn", "Chưa kết hôn"];
var yValues = [marital0, marital1];
var barColors = [
  "#ffc84b",
  "#e8c3b9",

];

new Chart("marital_status", {
  type: "pie",
  data: {
    labels: xValues,
    datasets: [{
      backgroundColor: barColors,
      data: yValues
    }]
  },
  options: {
    title: {
      display: true,
    }
  }
});
</script>
<script>
      const gender0 = document.getElementById("gender0").innerText;
      const gender1 = document.getElementById("gender1").innerText;


var xValues = ["Nam", "Nữ"];
var yValues = [gender0, gender1,];
var barColors = [
  "#86FEAC",
  "#C4F4FF",

];

new Chart("gender", {
  type: "pie",
  data: {
    labels: xValues,
    datasets: [{
      backgroundColor: barColors,
      data: yValues
    }]
  },
  options: {
    title: {
      display: true,
    }
  }
});
</script>
<script>
      const education0 = document.getElementById("education0").innerText;
      const education1 = document.getElementById("education1").innerText;
      const education2 = document.getElementById("education2").innerText;
      const education3 = document.getElementById("education3").innerText;

var xValues = ["Trung học", "Cử nhân", "Sau đại học", "Chuyên gia"];
var yValues = [education0, education1, education2, education3];
var barColors = [
  "#ffc84b",
  "#29badb",
  "#f17171",
  "#e8c3b9",
];

new Chart("Chart1", {
  type: "doughnut",
  data: {
    labels: xValues,
    datasets: [{
      backgroundColor: barColors,
      data: yValues
    }]
  },
  options: {
    title: {
      display: true,
    }
  }
});
</script>

<script>
    var xValues = ["Italy", "France", "Spain"];
    var yValues = [55, 49, 44];
    var barColors = [
        "#b91d47",
        "#00aba9",
        "#2b5797",
    ];

    new Chart("myChartTr", {
        type: "doughnut",
        data: {
            labels: xValues,
            datasets: [{
                backgroundColor: barColors,
                data: yValues
            }]
        },
    });
</script>


<script src="{% static 'libs/bootstrap/js/bootstrap.bundle.min.js'%}"></script>
<script src="{% static 'libs/simplebar/simplebar.min.js'%}"></script>
<script src="{% static 'libs/node-waves/waves.min.js'%}"></script>
<script src="{% static 'libs/feather-icons/feather.min.js'%}"></script>
<script src="{% static 'js/pages/plugins/lord-icon-2.1.0.js'%}"></script>
<script src="{% static 'js/plugins.js'%}"></script>


<!-- apexcharts -->
<script src="{% static 'libs/apexcharts/apexcharts.min.js'%}"></script>

<!-- Vector map-->
<script src="{% static 'libs/jsvectormap/js/jsvectormap.min.js'%}"></script>
<script src="{% static 'libs/jsvectormap/maps/world-merc.js'%}"></script>

<!-- Dashboard init -->
<script src="{% static 'js/pages/dashboard-analytics.init.js'%}"></script>

<!-- App js -->
<script src="{% static 'js/app.js'%}"></script>


<!-- apexcharts -->
<script src="{% static 'libs/apexcharts/dist/apexcharts.min.js'%}"></script>

<!-- Vector map-->
<script src="{% static 'libs/jsvectormap/dist/js/jsvectormap.min.js'%}"></script>
<script src="{% static 'libs/jsvectormap/dist/maps/world-merc.js'%}"></script>

<!--Swiper slider js-->
<script src="{% static 'libs/swiper/swiper-bundle.min.js'%}"></script>

<!-- Dashboard init -->
<script src="{% static 'js/pages/dashboard-ecommerce.init.js'%}"></script>


{% endblock extra_js %}